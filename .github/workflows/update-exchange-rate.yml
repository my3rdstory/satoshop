name: í™˜ìœ¨ ìë™ ì—…ë°ì´íŠ¸

on:
  schedule:
    # 5ë¶„ë§ˆë‹¤ ì‹¤í–‰ (UTC ê¸°ì¤€)
    - cron: '*/5 * * * *'
  workflow_dispatch: # ìˆ˜ë™ ì‹¤í–‰ ë²„íŠ¼

jobs:
  update-exchange-rate:
    runs-on: ubuntu-latest
    
    steps:
    - name: ì½”ë“œ ì²´í¬ì•„ì›ƒ
      uses: actions/checkout@v4
    
    - name: Python 3.13 ì„¤ì •
      uses: actions/setup-python@v4
      with:
        python-version: '3.13'
    
    - name: uv ì„¤ì¹˜
      uses: astral-sh/setup-uv@v3
      with:
        version: "latest"
    
    - name: ì˜ì¡´ì„± ì„¤ì¹˜
      run: uv sync
    
    - name: í™˜ìœ¨ ì—…ë°ì´íŠ¸ ì‹¤í–‰
      env:
        DATABASE_URL: ${{ secrets.DATABASE_URL }}
        SECRET_KEY: ${{ secrets.SECRET_KEY }}
        ALLOWED_HOSTS: ${{ secrets.ALLOWED_HOSTS }}
        ENABLE_DJANGO_SCHEDULER: false
      run: |
        echo "ğŸš€ GitHub Actionsì—ì„œ í™˜ìœ¨ ì—…ë°ì´íŠ¸ ì‹œì‘"
        uv run python manage.py update_exchange_rate --verbose
        echo "âœ… í™˜ìœ¨ ì—…ë°ì´íŠ¸ ì™„ë£Œ"
    
    - name: ì‹¤í–‰ ê²°ê³¼ ì•Œë¦¼ (ì‹¤íŒ¨ ì‹œ)
      if: failure()
      run: |
        echo "âŒ í™˜ìœ¨ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨"
        echo "GitHub Actions ë¡œê·¸ë¥¼ í™•ì¸í•˜ì„¸ìš”: https://github.com/${{ github.repository }}/actions" 