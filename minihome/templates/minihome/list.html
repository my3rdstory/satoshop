{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>미니홈 목록</title>
  <link rel="icon" type="image/png" href="{% static 'images/satoshop-logo-1x1-favicon.png' %}">
  <link rel="shortcut icon" type="image/png" href="{% static 'images/satoshop-logo-1x1-favicon.png' %}">
  <link rel="apple-touch-icon" href="{% static 'images/satoshop-logo-1x1-favicon.png' %}">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="{% static 'js/tailwind-config.js' %}"></script>
  <link rel="stylesheet" href="{% static 'minihome/css/list.css' %}">
  <script>
    (function() {
      let theme = 'light';
      try {
        const stored = localStorage.getItem('theme');
        if (stored) {
          theme = stored;
        } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
          theme = 'dark';
        }
      } catch (e) {
        theme = 'light';
      }
      document.documentElement.classList.toggle('dark', theme === 'dark');
      document.documentElement.setAttribute('data-theme', theme);
    })();
  </script>
</head>
<body class="min-h-screen bg-gradient-to-b from-slate-950 via-slate-900 to-slate-950 text-slate-100 text-sm">
  <svg xmlns="http://www.w3.org/2000/svg" width="256" height="256" viewBox="0 0 24 24" fill="none" stroke="#f7931a" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="minihome-glow" aria-hidden="true">
    <path d="M11.767 19.089c4.924.868 6.14-6.025 1.216-6.894m-1.216 6.894L5.86 18.047m5.908 1.042-.347 1.97m1.563-8.864c4.924.869 6.14-6.025 1.215-6.893m-1.215 6.893-3.94-.694m5.155-6.2L8.29 4.26m5.908 1.042.348-1.97M7.48 20.364l3.126-17.727"/>
  </svg>
  <main class="px-4 py-10">
    <div class="minihome-shell">
      <header class="text-center space-y-3">
        <p class="text-xs uppercase tracking-[0.4em] text-slate-400">Minihome</p>
        <h1 class="text-2xl font-semibold font-display">공개된 미니홈</h1>
        <p class="text-xs text-slate-300">카드를 클릭하면 새 탭으로 이동합니다.</p>
      </header>

      <section class="mt-8 grid gap-4">
        {% for minihome in minihomes %}
          {% if minihome.domain %}
            {% with target_link="//"|add:minihome.domain|add:"/" %}
              <a class="minihome-card" href="{{ target_link }}" target="_blank" rel="noopener">
                <div>
                  <h2 class="text-lg font-semibold">{{ minihome.display_name|default:minihome.slug }}</h2>
                  <p class="text-xs text-slate-300">{{ minihome.domain }}</p>
                </div>
                <span class="minihome-pill">도메인 연결</span>
              </a>
            {% endwith %}
          {% else %}
            <a class="minihome-card" href="{{ minihome_base_path }}{{ minihome.slug }}/" target="_blank" rel="noopener">
              <div>
                <h2 class="text-lg font-semibold">{{ minihome.display_name|default:minihome.slug }}</h2>
                <p class="text-xs text-slate-300">{{ minihome_base_path }}{{ minihome.slug }}/</p>
              </div>
              <span class="minihome-pill">슬러그 기반</span>
            </a>
          {% endif %}
        {% empty %}
          <div class="minihome-empty">아직 공개된 미니홈이 없습니다.</div>
        {% endfor %}
      </section>
    </div>
  </main>

  <script src="{% static 'minihome/js/list.js' %}"></script>
</body>
</html>
